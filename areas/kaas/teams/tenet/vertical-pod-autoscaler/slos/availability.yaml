---
description: "VPA's component(s) is/are unavailable"
alertName: "VPAComponentUnavailable"
objective: 95
errorQuery: '{{`sum(label_replace(avg_over_time(kube_pod_status_ready{condition="false",pod=~"vertical-pod-autoscaler-app-updater.*|vertical-pod-autoscaler-app-recommender.*|vertical-pod-autoscaler-app-admission-controller.*",cluster_id=~"^.*"}[{{.window}}]), "pod", "$1", "cluster_id", "$2")) by (pod, cluster_id, cluster_type, customer, installation, pipeline, provider, region)`}}'
totalQuery: '{{`sum(label_replace(avg_over_time(kube_pod_container_info{container=~"recommender|admission-controller|updater|vertical-pod-autoscaler-app",cluster_id=~"^.*"}[{{.window}}]), "pod", "$1", "cluster_id", "$2")) by (pod, cluster_id, cluster_type, customer, installation, pipeline, provider, region)`}}'
annotations:
  runbook_url: https://intranet.giantswarm.io/docs/support-and-ops/ops-recipes/vpa-down/
alertLabels:
  silence: "true"
  cancel_if_outside_working_hours: '{{ include "workingHoursOnly" . }}'
  cancel_if_cluster_status_updating: "true"
  cancel_if_monitoring_agent_down: "true"
