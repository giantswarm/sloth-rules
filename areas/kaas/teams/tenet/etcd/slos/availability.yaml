---
description: "ETCD availability error rate is too high"
alertName: "ETCDAvailabilityErrorRateTooHigh"
objective: 99
sharedAccrossProviders: true
# Error Query: Tracks non-OK gRPC responses while filtering out transient, retryable errors.
# Uses burn rate logic to detect if the error budget is consumed too quickly over short and long windows.
# Exclude retryable transient errors; triggers if error rate exceeds 1% (aligned with 99% SLO)
errorQuery: '{{`(sum(rate(grpc_client_handled_total{job="apiserver",grpc_service=~"etcd.*",grpc_code!~"OK|UNAVAILABLE"}[{{.window}}])) by (cluster_id, cluster_type, customer, installation, pipeline, provider, region) / sum(rate(grpc_client_handled_total{job="apiserver",grpc_service=~"etcd.*"}[{{.window}}])) by (cluster_id, cluster_type, customer, installation, pipeline, provider, region) > 0.01)`}}'
# Total Query: Measures the total number of gRPC requests to ETCD for normalization.
totalQuery: '{{`sum(rate(grpc_client_handled_total{job="apiserver",grpc_service=~"etcd.*"}[{{.window}}])) by (cluster_id, cluster_type, customer, installation, pipeline, provider, region)`}}'
alertLabels:
  silence: "true"
  cancel_if_outside_working_hours: '{{ include "workingHoursOnly" . }}'
annotations:
  opsrecipe: service-level-burn-rate-too-high/
