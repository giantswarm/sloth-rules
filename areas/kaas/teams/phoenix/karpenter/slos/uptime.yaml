---
alertLabels:
  cancel_if_any_apiserver_down: "true"
  cancel_if_cluster_status_creating: "true"
  cancel_if_cluster_status_updating: "true"
  cancel_if_cluster_status_deleting: "true"
  cancel_if_cluster_has_no_workers: "true"
alertName: "KarpenterServiceDegraded"
annotations:
  dashboard: e8ea41bb-55a8-48c5-a070-262551ad3722/karpenter
  description: Karpenter is experiencing a service degradation in cluster {{$labels.installation}}/{{$labels.cluster_id}}.
cluster_type: workload_cluster
description: "Karpenter SLO"
objective: 80
topic: kubernetes
errorQuery: sum(label_replace(avg_over_time(kube_pod_status_ready{condition="false",namespace="kube-system"}[{{.window}}]), "cluster_id", "$1", "pod", "karpenter.*")) by (pod, cluster_id, cluster_type, customer, installation, pipeline, provider, region)
totalQuery: sum(label_replace(avg_over_time(kube_pod_status_ready{namespace="kube-system"}[{{.window}}]), "cluster_id", "$1", "pod", "karpenter.*")) by (pod, cluster_id, cluster_type, customer, installation, pipeline, provider, region)