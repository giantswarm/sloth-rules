---
description: "Ingress availability SLO"
alertName: "IngressAvailabilityErrorRateTooHigh"
objective: 99
errorQuery: '{{`sum(label_replace(count_over_time(probe_success{target=~"ingress-sla-.*-blackbox"}[{{.window}}]) - sum_over_time(probe_success{target=~"ingress-sla-.*-blackbox"}[{{.window}}]), "ingress_class", "$1", "target", "ingress-sla-(.*)-blackbox")) by (cluster_id, cluster_type, customer, installation, pipeline, provider, region, ingress_class)`}}'
totalQuery: '{{`sum(label_replace(count_over_time(probe_success{target=~"ingress-sla-.*-blackbox"}[{{.window}}]), "ingress_class", "$1", "target", "ingress-sla-(.*)-blackbox")) by (cluster_id, cluster_type, customer, installation, pipeline, provider, region, ingress_class)`}}'
alertLabels:
  cancel_if_cluster_status_updating: "true"
  cancel_if_prometheus_agent_down: "true"
  cancel_if_outside_working_hours: '{{ include "workingHoursOnly" . }}'
annotations:
  opsrecipe: managed-app-nginx-ic/
